## Subjects with Issues noted in the HCP Lifespan quality control process

As of the LS2.0 release, a subject data measure (QC_Issue_Codes) was added to the Completeness CSVs provided as part of the release to flag subjects and sessions (visits) with notable issues found in the HCP Quality Control process as described for each issue code below.  The issues are notable, but were not considered severe enough to exclude the subject's imaging data from release. We are sharing these findings of issues to alert users and allow them to decide whether to include or exclude these subjects in their own analyses.  

The QC_Issue_Codes measure allows users to filter the data for subjects with or without these issues in the project-specific Completeness CSV spreadsheet containing per subject imaging and behavioral completeness, QC Issues, and unrelated status.

    HCP-Aging LS2.0 Release Completeness CSV 
    HCP-Development LS2.0 Release Completeness CSV

As of the LS 3.0 Release, we also list the QC Issue codes only in this Excel spreadsheet with sheets for HCA, HCD, and a code key:

    LS3.0_Release_subjects_issue_codes.xlsx


### Note on the HCP QC process:

We explicitly reviewed the outputs of the HCP Structural Pipelines on all subjects and ascertained that all released subjects have at least reasonable (or better) cortical surface models. However, a comprehensive QC of all modalities has not been feasible, and HCP does not claim to have identified all QC issues for all subjects and modalities.  

Therefore, the absence of an issues code for a given subject does not imply that there are no issues with the data for this subject. We encourage users to alert us to issues that they discover.  We will then update the QC_Issue_Codes and wiki appropriately for the benefit of other users.
QC Issue A: Anatomical anomalies

All structural scans, FreeSurfer white matter segmentations, and surface outputs from the structural pipeline are subject to a standard quality control process that involves manual viewing and rating of scan quality and anatomical abnormalities by an experienced rater. Brain anomalies evident in T1w and T2w scans were noted and further reviewed by a radiologist. Subjects with major radiologic anomalies that were expected to substantially impact brain connectivity were removed from the study, and their imaging and behavioral data are not included in the released data. 

Some subjects flagged with issue code A in the QC_Issue_Codes column of HCP-Aging Completeness CSV or HCP-Development Completeness CSV had focal anomalies that are considered as normal variants or benign findings, especially considering the subject’s age (e.g. older subjects may have evidence of prior stroke). We have released their data, but because of their altered anatomy, using data from these subjects may affect some analyses. 

Location and kind of anomaly for each of the QC Issue A subjects are detailed in these spreadsheet of Anatomical QC Findings (LS3.0 is cumulative and includes all subjects released in LS2.0):

HCP-Aging:

HCA_LS2.0_anat_anomalies_Rad_reads.xlsx

HCA_LS3.0_anat_anomalies_Rad_reads.xlsx

HCP-Development:

HCD_LS2.0_anat_anomalies_Rad_reads.xlsx

HCD_LS3.0_anat_anomalies_Rad_reads.xlsx

Slides of the structural images showing the Anatomical QC Findings for QC Issue A subjects: 

HCP-Aging:

HCA_LS2.0_anatomical_anomalies.pdf

HCA_LS3.0_anatomical_anomalies_Rad_reads.pdf

HCP-Development:

HCD_LS2.0_anatomical_anomalies.pdf

HCD_LS3.0_anatomical_anomalies_Rad_reads.pdf
QC Issue B: Surface Imperfections (Not edited)

Brain structure white matter segmentation results, white, and pial surfaces generated by FreeSurfer as part of the HCP structural pipeline were inspected by a rater for any notable issues. If there were notable white matter segmentation or surface errors, we first reran the structural pipeline to attempt to fix the issues in an automated way. If that didn’t fix the issue, hand editing of white matter segmentations and surfaces was implemented in some individuals (see “QC Issue E” section).

For some subjects with focal white matter segmentation and surface errors, hand editing was unable to fix the issue or it was unclear what part of the white matter segmentation should be edited.  These subjects have a B series code (described below) in the QC_Issue_Codes column of HCP-Aging LS2.0 Completeness CSV or HCP-Development LS2.0 Completeness CSV.

The majority of subjects with B codes were not edited and the remaining subjects with B codes after edits often have additional imperfections that were not necessarily the focus of intended edits (E codes). Typically, if the edits to a particular imperfection didn't fix the issue, we didn't use the edit.

In the following descriptions, “deep” and “superficial” refers to how deeply or superficially the surface’s segmentation outline cuts into the volume. Too deep means that the white surface outline is erroneously not capturing all the white matter it should, or the pial surface outline is erroneously not capturing all the grey matter that it should. Too superficial means that the white or pial surface outline is erroneously capturing too much (not just white or grey matter, respectively).

Examples of these B series imperfections are shown and described in these slides: LS3.0_B_code_examples.pdf


B1) white surface imperfections

B1a. White surface too deep (segmentation of white matter does not capture all white matter and grey matter segmentation will include some white matter) – this may happen near the claustrum, in very lightly myelinated white matter, and in susceptibility areas

B1b. White surface too superficial (segmentation of white matter extends into grey matter)

B1c. Other [e.g. missed gyri or missed sulci]

B2) pial surface imperfections

B2a. Pial surface too deep (segmentation of grey matter fails to capture all grey matter)

B2b. Pial surface too superficial: blood vessel/venous sinus inclusion

B2c. Pial surface too superficial: dural inclusion

B2d. Other [e.g. pial surface extending into other structures like bone marrow] 

B3) white & pial surface errors due to Virchow-Robin spaces


Note: Many HCP-Development subjects have Issues B1b and/or B2b. We see a high frequency of surface imperfections due to white and pial surface outlines being pulled away from the boundaries than in HCA subjects. We have yet to identify the reasons why this is the case in HCP-D and not in HCP-A.


QC Issue C: Myelin Map Notable Quality Issues (beyond those caused by surface imperfections covered by issue code B)

Myelin maps generated by the HCP structural pipeline from the T1w and T2w images were inspected by a rater for any notable issues. 

C1) Myelin map non-uniformity (due to non-uniform intensity within the T1 and/or T2 scan)

C2) Low myelin map quality due to low quality of the T1 and/or T2 scan, may be correlated with C1 

C3) Myelin map abnormalities due to aging effects (non-editable effects such as atrophy, etc.)

C4) Myelin map quality issues (“choppiness” or streaking) likely due to uncorrected B1- due to motion or large B1+ effects. 

C5) MSMSulc misidentifies central sulcus in myelin map due to similarity of multiple sulci, fixed by MSMAll (use MSMAll processed recommended data in analyses)
QC Issue D: FNIRT issues 

When surfaces become highly distorted during registration to MNINonLinear space we flag with the issue code D for the QC_Issue measure. The distortion is likely caused by an ACPC alignment issue in younger subjects or extreme brain atrophy in older subjects. 


QC Issue E: Processing Deviations to improve processing results

E1) FreeSurfer wm.mgz edits (fix white matter surface errors. i.e. when the white surface is too superficial or to fill in white matter hypo/hyperintensity blemishes) 

E2) FreeSurfer brainmask.mgz edits (fix pial surface errors. i.e. when pial surface is too superficial)  

These errors were common, but generally the pial surface blemishes were small, and thus these edits were discontinued early in the editing process due to time constraints.

E3) FreeSurfer control point addition (to capture cortical matter that FreeSurfer missed).  

Adding control points was determined to be equally or less effective at improving surfaces than editing wm.mgz so these edits were discontinued early in the editing process. 

E4) FreeSurfer -bigventricles flag used (for some HCA subjects)

This flag improved the FreeSurfer subcortical segmentations in subjects with enlarged ventricles.

E5) Alternative FNIRT Config for nonlinear registration in PreFreeSurfer pipeline (HCA)

This config improved the FNIRT nonlinear alignment of subjects with more variable brain anatomy (e.g., due to increased atrophy). 

E6) Alternative small head template (built from 5-7 year olds) for linear registration in PreFreeSurfer (HCD)

This template improved the linear initialization of HCD subjects whose head shapes differed substantially from the MNI template due to their immaturity.

E7) Alternative template (built from large HCA heads) for linear registration in PreFreeSurfer (HCA)

This template improved the linear initialization of HCA subjects with larger heads due to additional scalp tissue.
